---
title: "RMarkdown Admissions_Survey2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(devtools)
library(usethis)
library(devtools)
library(likert)
# Load RColorBrewer
# install.packages("RColorBrewer")
library(RColorBrewer)
library("stringr")                   # Load stringr package, used for wrapping label text in plots
library(dplyr)    # Used for filtering below
library(scales) # Used for adding percentages to bar charts

# Define colour palettes for plots below
coul3 <- brewer.pal(3, "RdYlBu") # Using RdYlBu range to generate 3 colour palette: https://colorbrewer2.org/#type=diverging&scheme=RdYlBu&n=5

TSR_data <- read.csv("./data/TSR data complete.csv")
subject_data <- read.csv("./data/Subject data.csv")

# Set up local workspace:
if (dir.exists("data") == FALSE) {
  dir.create("data") 
}
if (dir.exists("figures") == FALSE) {
  dir.create("figures") 
}
if (dir.exists("derivedData") == FALSE) {
  dir.create("derivedData")
}
```

# Basic demographic summary visualisations:
```{r demographic_summaries}

# 1. Calculate for age of respondent:

# JK note: To keep things tidy, I've shifted the code here so that this isn't overwriting the dataset, but is instead operating off a separate df (same below)
TSR_data_summaries_age <- factor(TSR_data$Age, levels = c(1, 2, 3, 4, 5, 6, 7, 8), labels = c("15 or under", "16", "17", "18", "19", "20", "21 or over", "Prefer not to say"))
age_pie <- pie(table(TSR_data_summaries_age), col=coul3, cex = 0.8)
# JK note: adding in a bar chart here, as according to the interwebs it's (apparently?) more accurate to visualise than bar charts
data_summaries_age <- ggplot(TSR_data, aes(TSR_data_summaries_age)) + geom_bar()
data_summaries_age + labs(title = "Respondent Age Distribution", x = "Age", y = "")
# save to png file for reports
ggsave("figures/TSR_data_summaries_age.png")

# 2. Calculate for year of study:

TSR_data_summaries_yos <- factor(TSR_data$MOSTRECENTyearofstudy, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9), labels = c("Year 11/S4/Year 12(NI)", "Year 12/S5/Year 13(NI)", "Year 13/S6/Year 14(NI)", "I am currently on a gap year", "I am currently on an undergraduate/HE college course", "I am in full-time employment", "I am unemployed", "Other", "Prefer not to say"))

data_summaries_yos <- ggplot(TSR_data, aes(TSR_data_summaries_yos)) + geom_bar()
data_summaries_yos + labs(title = "Respondent Most Recent Year of Study", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_summaries_yos.png")

# 3. Gender identity:

TSR_data_summaries_gender <- factor(TSR_data$Gender, levels = c(1, 2, 3, 4), labels = c("Male", "Female", "I identify my gender in another way", "Prefer not to say"))
# JK note: using stringr here to wrap axis titles
TSR_data_summaries_gender <- str_wrap(TSR_data_summaries_gender, width = 10)

data_summaries_gender <- ggplot(TSR_data, aes(TSR_data_summaries_gender)) + geom_bar()
data_summaries_gender + labs(title = "Respondent gender self-identification", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_summaries_gender.png")

# 4. Ethnic self-identification:

TSR_data_summaries_ethnicity <- factor(TSR_data$Ethnicity, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17 ,18, 19), labels = c("Arab", "Indian", "Pakistani", "Bangladeshi", "Chinese", "Any other Asian background", "Black - African", "Black - Caribbean", "Any other Black background", "Mixed - White and Black Caribbean", "Mixed - White and Black African", "Mixed - White and Black Asian", "Any other Mixed/Multiple Ethnic background", "White - British", "White - Irish", "Gypsy or Irish Traveller", "Any other White background", "Other Ethnic group", "Prefer not to say"))
TSR_data_summaries_ethnicity <- str_wrap(TSR_data_summaries_ethnicity, width = 30)

data_summaries_ethnicity <- ggplot(TSR_data, aes(TSR_data_summaries_ethnicity)) + geom_bar() +  xlab(NULL) + coord_flip()
data_summaries_ethnicity + labs(title = "Respondent ethnic self-identification", x = "", y = "")

# save to png file for reports
ggsave("figures/TSR_data_summaries_ethnicity.png")

# 5. Religion

TSR_data_summaries_religion <- factor(TSR_data$ReligiousAffliation, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19), labels = c("Agnostic", "Atheist", "Baha'i", "Buddhist", "Christian", "Confucian", "Jain", "Jewish", "Hindu", "Indigenous Traditional Religious", "Muslim", "Pagan", "Shinto", "Sikh", "Spiritual but not religious", "Zoroastrian", "No religion", "Prefer not to say", "Other"))

# Adding a subset for charting out composition of group which specifically marked positive sentiments wrt/ theology or religious studies

TSR_data_theology_positive <- filter(TSR_data, InterestedinstudyingTheology >= 4 & InterestedinstudyingTheology != 0)
TSR_data_theology_negative <- filter(TSR_data, InterestedinstudyingTheology <= 2 & InterestedinstudyingTheology != 0)

TSR_data_rs_positive <- filter(TSR_data, InterestedinstudyingReligiousStudies >= 4 & InterestedinstudyingReligiousStudies != 0)
TSR_data_rs_negative <- filter(TSR_data, InterestedinstudyingReligiousStudies <= 2 & InterestedinstudyingReligiousStudies != 0)

TSR_data_theology_positive_summaries_religion <- factor(TSR_data_theology_positive$ReligiousAffliation, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19), labels = c("Agnostic", "Atheist", "Baha'i", "Buddhist", "Christian", "Confucian", "Jain", "Jewish", "Hindu", "Indigenous Traditional Religious", "Muslim", "Pagan", "Shinto", "Sikh", "Spiritual but not religious", "Zoroastrian", "No religion", "Prefer not to say", "Other"))

TSR_data_theology_negative_summaries_religion <- factor(TSR_data_theology_negative$ReligiousAffliation, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19), labels = c("Agnostic", "Atheist", "Baha'i", "Buddhist", "Christian", "Confucian", "Jain", "Jewish", "Hindu", "Indigenous Traditional Religious", "Muslim", "Pagan", "Shinto", "Sikh", "Spiritual but not religious", "Zoroastrian", "No religion", "Prefer not to say", "Other"))

TSR_data_rs_positive_summaries_religion <- factor(TSR_data_rs_positive$ReligiousAffliation, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19), labels = c("Agnostic", "Atheist", "Baha'i", "Buddhist", "Christian", "Confucian", "Jain", "Jewish", "Hindu", "Indigenous Traditional Religious", "Muslim", "Pagan", "Shinto", "Sikh", "Spiritual but not religious", "Zoroastrian", "No religion", "Prefer not to say", "Other"))

TSR_data_rs_negative_summaries_religion <- factor(TSR_data_rs_negative$ReligiousAffliation, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19), labels = c("Agnostic", "Atheist", "Baha'i", "Buddhist", "Christian", "Confucian", "Jain", "Jewish", "Hindu", "Indigenous Traditional Religious", "Muslim", "Pagan", "Shinto", "Sikh", "Spiritual but not religious", "Zoroastrian", "No religion", "Prefer not to say", "Other"))

# Calculate graphs

Religious_affiliation_bar <- ggplot(TSR_data, aes(TSR_data_summaries_religion)) + geom_bar() + coord_flip()
Religious_affiliation_bar + labs(title = "Respondent religious self-identification", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_summaries_religion.png")

# Additional graphs for theology/rs positive sentiment cohorts

# Theology

# JK note: need to add percentages to each line, as per https://stackoverflow.com/questions/52373049/display-percentage-on-ggplot-bar-chart-in-r

Religious_affiliation_bar2 <- ggplot(TSR_data_theology_positive, aes(TSR_data_theology_positive_summaries_religion)) + geom_bar() + coord_flip()
Religious_affiliation_bar2 + labs(title = "Respondent religious self-identification, positive sentiment towards theology", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_summaries_religion_theologypositive.png")

# RS

Religious_affiliation_bar3 <- ggplot(TSR_data_rs_positive, aes(TSR_data_rs_positive_summaries_religion)) + geom_bar() + coord_flip()
Religious_affiliation_bar3 + labs(title = "Respondent religious self-identification, positive sentiment towards rs", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_summaries_religion_rspositive.png")

irisNew <- iris %>% group_by(Species) %>% 
 summarize(count = n()) %>%  # count records by species
 mutate(pct = count/sum(count))  # find percent of total

ggplot(irisNew, aes(Species, pct, fill = Species)) + 
  geom_bar(stat='identity') + 
  geom_text(aes(label=scales::percent(pct)), position = position_stack(vjust = .5))+
  scale_y_continuous(labels = scales::percent)
```

# Visualisations of LIKERT responses (RH):
- For questions Q6 (subject interest) / Q5 (subject knowledge) / Q7 employability prospects: 
	- visualisation as summaries for all subjects LIKERT data as stacked bar chart (colours for bar segments from cool to warm)
	
```{r Visualization by Subject}
### Each Subject is a different column so will need to figure out how to code the columns together into one graph
  # Higher score indicates less agreement...need to reverse score

## 1=5, 2=4, 3=3, 4=2, 5=1, 6=0 --- Not done yet. See what they look like without reverse scoring

## Files have been reverse scored - Higher score now indicates more agreement


#Q5 Subject Knowledge/Understanding
subject_data$Subject <- factor(subject_data$Subject, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), labels = c("Philosophy", "Sociology", "Psychology", "History", "Ethics", "Theology", "Religious Studies", "Politics", "English", "Math", "Computer Science", "Business"))

understanding_mean <- aggregate(Understanding ~ Subject, data = subject_data, mean)

understanding_bar <- ggplot(understanding_mean, aes(x = Subject, y = Understanding)) + stat_summary(fun = "mean", geom = "bar") + coord_flip()
understanding_bar + labs(title = "I have a good understanding of what this subject involves?", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_subject_understanding.png")


#Q6 Subject Interest
interest_mean <- aggregate(Interest ~ Subject, data = subject_data, mean)

interest_bar <- ggplot(interest_mean, aes(x = Subject, y = Interest)) + stat_summary(fun = "mean", geom = "bar") + coord_flip()
interest_bar + labs(title = "I would be interested in studying this subject at University?", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_subject_interest.png")

#Q7 Employability Prospects

employability_mean <- aggregate(Employability ~ Subject, data = subject_data, mean)

employability_bar <- ggplot(employability_mean, aes(x = Subject, y = Employability)) + stat_summary(fun = "mean", geom = "bar") + coord_flip()
employability_bar + labs(title = "please rate ... employability prospects", x = "", y = "")
# save to png file for reports
ggsave("figures/TSR_data_subject_employability.png")

### Categorical Graph ###

#devtools::install_github('jbryer/likert')

#likert_test <- likert(subject_data)
Understanding_data <- TSR_data[, 6:17]
likert_test_understand <- likert(Understanding_data)

Interest_data <- TSR_data[, 18:29]

Employability_data <- TSR_data[, 30:41]

```

	- separate visualisation of summary data as pie chart only for 4 key subjects: Philosophy, Ethics, Theology, Religious Studies, but with data represented as aggregated "Positive" / "Negative" responses
	
```{r Visualization for 4 Key Subjects}
## Subset by "Positive" / "Negative"

keysubjects_data <- subject_data[subject_data$Subject == "Philosophy" | subject_data$Subject == "Ethics" | subject_data$Subject == "Theology" | subject_data$Subject == "Religious Studies" | subject_data$Subject == "Sociology" | subject_data$Subject == "Psychology" | subject_data$Subject == "History" | subject_data$Subject == "Politics" | subject_data$Subject == "English" | subject_data$Subject == "Math" | subject_data$Subject == "Computer Science" | subject_data$Subject == "Business", ]

recode_interest <- ifelse(2 <= keysubjects_data$Interest & keysubjects_data$Interest >=4, "Positive", "Negative")

keysubjects_data <- cbind(keysubjects_data, recode_interest)
keysubjects_data$recode_interest <- factor(keysubjects_data$recode_interest)

interest_table <- table(keysubjects_data$recode_interest, keysubjects_data$Subject)
# export table to csv
write.csv(interest_table, "derivedData/interest_table.csv", row.names=TRUE)



```
	- subsetted visualisations of responses with separate subsetting by response to Q8-9, Q18, Q17, Q16
- For question Q8 + Q9 (for religious people) 
	- visualisation summary of responses
	- show subsetted visualisations of responses by response to, Q18, Q17, Q16, Q13, Q14
- For responses to Q10-12 (what subjects are involved in...):
	- represent answer counts as descending bar chart for each Q
	- subset answers by Q6 (positive / negative) and Q5 (positive / negative)

# Correlation testing:
- For Q6 (subject interest) / Q5 (subject knowledge) / Q7 employability prospects, test for nature / strength of correlation with responses to:
	- Q8-9 responses
	- Q18 responses
	- Q17


```{r Q6 Correlations - Subject Interest}
#Q8-9 (8 - Theology as subject for religious people; 9 - Religion as study for religious people)
  # This would be suitable for correlation

#Q17 (Ethnicity)
  # This would be categorical, so ANOVA

#Q18 (Religion)
  # This would also be categorical, so ANOVA

```

```{r Q5 Correlations - Subject Knowledge}
#Q8-9 (8 - Theology as subject for religious people; 9 - Religion as study for religious people)
  # This would be suitable for correlation

#Q17 (Ethnicity)
  # This would be categorical, so ANOVA

#Q18 (Religion)
  # This would also be categorical, so ANOVA
```

```{r Q7 Correlations - Employability}
#Q8-9 (8 - Theology as subject for religious people; 9 - Religion as study for religious people)
  # This would be suitable for correlation

#Q17 (Ethnicity)
  # This would be categorical, so ANOVA

#Q18 (Religion)
  # This would also be categorical, so ANOVA
```


```{r testing fun}
#testcor_data <- subject_data[subject_data$Subject == "Psychology" | subject_data$Subject == "Theology", ]

#t.test(Interest ~ Subject, data = testcor_data)

# testsubset <- TSR_data[TSR_data$Interested.in.Studying.Psychology < 3 & TSR_data$Interested.in.Studying.Psychology != 0, ]
# as.numeric(testsubset$Interested.in.studying.Theology)
# mean(testsubset$Interested.in.studying.Theology, na.rm = TRUE)
# 
# mean(as.numeric(testsubset$Interested.in.studying.Theology), na.rm = TRUE)
# 
# as.numeric(testsubset$Interested.in.studying.Religious.Studies)
# mean(testsubset$Interested.in.studying.Religious.Studies, na.rm = TRUE)
# 
# testsubset2 <- TSR_data[TSR_data$Interested.in.Studying.Psychology > 3, ]
# mean(as.numeric(testsubset2$Interested.in.studying.Theology), na.rm = TRUE)
# mean(as.numeric(testsubset2$Interested.in.studying.Religious.Studies), na.rm = TRUE)
```

## Mean Interest in Theology and Religious Studies by High/Low Subject Interest

```{r Philosophy}
### Philosophy ###
Philos_subset_Low <- TSR_data[TSR_data$InterestinstudyingPhilosophy < 3 & TSR_data$InterestinstudyingPhilosophy != 0, ]

Philos_subset_High <- TSR_data[TSR_data$InterestinstudyingPhilosophy > 3, ]

## Theology Interest
#Low interest in Philosophy
mean(as.numeric(Philos_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Philosophy
mean(as.numeric(Philos_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Philosophy
mean(as.numeric(Philos_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Philosophy
mean(as.numeric(Philos_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r Sociology}
### Sociology ###
Soc_subset_Low <- TSR_data[TSR_data$InterestinstudyingSociaology < 3 & TSR_data$InterestinstudyingSociaology != 0, ]

Soc_subset_High <- TSR_data[TSR_data$InterestinstudyingSociaology > 3, ]

## Theology Interest
#Low interest in Sociology
lSocTheo <- mean(as.numeric(Soc_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Sociology
hSocTheo <- mean(as.numeric(Soc_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Sociology
mean(as.numeric(Soc_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Sociology
mean(as.numeric(Soc_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r Psychology}
### Psychology ###
Psych_subset_Low <- TSR_data[TSR_data$InterestedinStudyingPsychology < 3 & TSR_data$InterestedinStudyingPsychology != 0, ]

Psych_subset_High <- TSR_data[TSR_data$InterestedinStudyingPsychology > 3, ]

## Theology Interest
#Low interest in Psychology
mean(as.numeric(Psych_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Psychology
mean(as.numeric(Psych_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Psychology
mean(as.numeric(Psych_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Psychology
mean(as.numeric(Psych_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r History}
### History ###
Hist_subset_Low <- TSR_data[TSR_data$InterestedinstudyingHistory < 3 & TSR_data$InterestedinstudyingHistory != 0, ]

Hist_subset_High <- TSR_data[TSR_data$InterestedinstudyingHistory > 3, ]

## Theology Interest
#Low interest in History
mean(as.numeric(Hist_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in History
mean(as.numeric(Hist_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in History
mean(as.numeric(Hist_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in History
mean(as.numeric(Hist_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r Ethics}
### Ethics ###
Ethics_subset_Low <- TSR_data[TSR_data$InterestedinstudyingEthics < 3 & TSR_data$InterestedinstudyingEthics != 0, ]

Ethics_subset_High <- TSR_data[TSR_data$InterestedinstudyingEthics > 3, ]

## Theology Interest
#Low interest in Ethics
mean(as.numeric(Ethics_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Ethics
mean(as.numeric(Ethics_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Ethics
mean(as.numeric(Ethics_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Ethics
mean(as.numeric(Ethics_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r Politics}
### Politics ###
Polit_subset_Low <- TSR_data[TSR_data$InterestedinstudyingPolitics < 3 & TSR_data$InterestedinstudyingPolitics != 0, ]

Polit_subset_High <- TSR_data[TSR_data$InterestedinstudyingPolitics > 3, ]

## Theology Interest
#Low interest in Politics
mean(as.numeric(Polit_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Politics
mean(as.numeric(Polit_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Politics
mean(as.numeric(Polit_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Politics
mean(as.numeric(Polit_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r English}
### English ###
Eng_subset_Low <- TSR_data[TSR_data$InterestedinstudyingEnglish < 3 & TSR_data$InterestedinstudyingEnglish != 0, ]

Eng_subset_High <- TSR_data[TSR_data$InterestedinstudyingEnglish > 3, ]

## Theology Interest
#Low interest in English
mean(as.numeric(Eng_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in English
mean(as.numeric(Eng_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in English
mean(as.numeric(Eng_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in English
mean(as.numeric(Eng_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r Math}
### Math ###
Math_subset_Low <- TSR_data[TSR_data$InterestedinstudyingMath < 3 & TSR_data$InterestedinstudyingMathy != 0, ]

Math_subset_High <- TSR_data[TSR_data$InterestedinstudyingMath > 3, ]

## Theology Interest
#Low interest in Math
mean(as.numeric(Math_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Math
mean(as.numeric(Math_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Math
mean(as.numeric(Math_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Math
mean(as.numeric(Math_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r Computer Science}
### Computer Science ###
CompSci_subset_Low <- TSR_data[TSR_data$InterestedinstudyingComputerScience < 3 & TSR_data$InterestedinstudyingComputerScience != 0, ]

CompSci_subset_High <- TSR_data[TSR_data$InterestedinstudyingComputerScience > 3, ]

## Theology Interest
#Low interest in Computer Science
mean(as.numeric(CompSci_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Computer Science
mean(as.numeric(CompSci_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Computer Science
mean(as.numeric(CompSci_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Computer Science
mean(as.numeric(CompSci_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)
```

```{r Business}
### Business ###
Busi_subset_Low <- TSR_data[TSR_data$InterestedinstudyingBusiness < 3 & TSR_data$InterestedinstudyingBusiness != 0, ]

Busi_subset_High <- TSR_data[TSR_data$InterestedinstudyingBusiness > 3, ]

## Theology Interest
#Low interest in Business
mean(as.numeric(Busi_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)
#High interest in Business
mean(as.numeric(Busi_subset_Low$InterestedinstudyingTheology), na.rm = TRUE)

## Religious Studies Interest
#Low interest in Business
mean(as.numeric(Busi_subset_Low$InterestedinstudyingReligiousStudies), na.rm = TRUE)
#High interest in Business
mean(as.numeric(Busi_subset_High$InterestedinstudyingReligiousStudies), na.rm = TRUE)

```


## Mean Knowledge in Theology and Religious Studies by High/Low Subject Knowledge

```{r Philosophy}
### Philosophy ###

# Low understanding of philosophy cohort
Philos_subset_Low <- TSR_data[TSR_data$GoodunderstandingofPhilosophy < 3 & TSR_data$GoodunderstandingofPhilosophy != 0, ]

# High understanding of philosophy cohort
Philos_subset_High <- TSR_data[TSR_data$GoodunderstandingofPhilosophy > 3, ]

## Theology Knowledge
#Low knowledge in Philosophy
mean(as.numeric(Philos_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Philosophy
mean(as.numeric(Philos_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies Knowledge
#Low knowledge in Philosophy
mean(as.numeric(Philos_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Philosophy
mean(as.numeric(Philos_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r Sociology}
### Sociology ###
Soc_subset_Low <- TSR_data[TSR_data$GoodunderstandingofSociology < 3 & TSR_data$GoodunderstandingofSociology != 0, ]

Soc_subset_High <- TSR_data[TSR_data$GoodunderstandingofSociology > 3, ]

## Theology knowledge
#Low knowledge in Sociology
mean(as.numeric(Soc_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Sociology
mean(as.numeric(Soc_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in Sociology
mean(as.numeric(Soc_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Sociology
mean(as.numeric(Soc_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r Psychology}
### Psychology ###
Psych_subset_Low <- TSR_data[TSR_data$GoodunderstandingofPsychology < 3 & TSR_data$GoodunderstandingofPsychology != 0, ]

Psych_subset_High <- TSR_data[TSR_data$GoodunderstandingofPsychology > 3, ]

## Theology knowledge
#Low knowledge in Psychology
mean(as.numeric(Psych_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Psychology
mean(as.numeric(Psych_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in Psychology
mean(as.numeric(Psych_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Psychology
mean(as.numeric(Psych_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r History}
### History ###
Hist_subset_Low <- TSR_data[TSR_data$GoodunderstandingofHistory < 3 & TSR_data$GoodunderstandingofHistory != 0, ]

Hist_subset_High <- TSR_data[TSR_data$GoodunderstandingofHistory > 3, ]

## Theology knowledge
#Low knowledge in History
mean(as.numeric(Hist_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in History
mean(as.numeric(Hist_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in History
mean(as.numeric(Hist_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in History
mean(as.numeric(Hist_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r Ethics}
### Ethics ###
Ethics_subset_Low <- TSR_data[TSR_data$GoodunderstandingofEthics < 3 & TSR_data$GoodunderstandingofEthics != 0, ]

Ethics_subset_High <- TSR_data[TSR_data$GoodunderstandingofEthics > 3, ]

## Theology knowledge
#Low knowledge in Ethics
mean(as.numeric(Ethics_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Ethics
mean(as.numeric(Ethics_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in Ethics
mean(as.numeric(Ethics_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Ethics
mean(as.numeric(Ethics_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r Politics}
### Politics ###
Polit_subset_Low <- TSR_data[TSR_data$GoodunderstandingofPolitics < 3 & TSR_data$GoodunderstandingofPolitics != 0, ]

Polit_subset_High <- TSR_data[TSR_data$GoodunderstandingofPolitics > 3, ]

## Theology knowledge
#Low knowledge in Politics
mean(as.numeric(Polit_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Politics
mean(as.numeric(Polit_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in Politics
mean(as.numeric(Polit_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Politics
mean(as.numeric(Polit_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r English}
### English ###
Eng_subset_Low <- TSR_data[TSR_data$GoodunderstandingofEnglish < 3 & TSR_data$GoodunderstandingofEnglish != 0, ]

Eng_subset_High <- TSR_data[TSR_data$GoodunderstandingofEnglish > 3, ]

## Theology knowledge
#Low knowledge in English
mean(as.numeric(Eng_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in English
mean(as.numeric(Eng_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in English
mean(as.numeric(Eng_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in English
mean(as.numeric(Eng_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r Math}
### Math ###
Math_subset_Low <- TSR_data[TSR_data$GoodunderstandingofMath < 3 & TSR_data$GoodunderstandingofMath != 0, ]

Math_subset_High <- TSR_data[TSR_data$GoodunderstandingofMath > 3, ]

## Theology knowledge
#Low knowledge in Math
mean(as.numeric(Math_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Math
mean(as.numeric(Math_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in Math
mean(as.numeric(Math_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Math
mean(as.numeric(Math_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r Computer Science}
### Computer Science ###
CompSci_subset_Low <- TSR_data[TSR_data$GoodunderstandingofComputerScience < 3 & TSR_data$GoodunderstandingofComputerScience != 0, ]

CompSci_subset_High <- TSR_data[TSR_data$GoodunderstandingofComputerScience > 3, ]

## Theology knowledge
#Low knowledge in Computer Science
mean(as.numeric(CompSci_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Computer Science
mean(as.numeric(CompSci_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in Computer Science
mean(as.numeric(CompSci_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Computer Science
mean(as.numeric(CompSci_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)
```

```{r Business}
### Business ###
Busi_subset_Low <- TSR_data[TSR_data$GoodunderstandingofBusiness < 3 & TSR_data$GoodunderstandingofBusiness != 0, ]

Busi_subset_High <- TSR_data[TSR_data$GoodunderstandingofBusiness > 3, ]

## Theology knowledge
#Low knowledge in Business
mean(as.numeric(Busi_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)
#High knowledge in Business
mean(as.numeric(Busi_subset_Low$GoodunderstandingofTheology), na.rm = TRUE)

## Religious Studies knowledge
#Low knowledge in Business
mean(as.numeric(Busi_subset_Low$GoodunderstandingofReligiousStudies), na.rm = TRUE)
#High knowledge in Business
mean(as.numeric(Busi_subset_High$GoodunderstandingofReligiousStudies), na.rm = TRUE)

```


## Mean Employability in Theology and Religious Studies by High/Low Subject Employability

```{r Philosophy}
### Philosophy ###
Philos_subset_Low <- TSR_data[TSR_data$Philosophyemployability < 3 & TSR_data$Philosophyemployability != 0, ]

Philos_subset_High <- TSR_data[TSR_data$Philosophyemployability > 3, ]

## Theology employability
#Low employability in Philosophy
mean(as.numeric(Philos_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Philosophy
mean(as.numeric(Philos_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Philosophy
mean(as.numeric(Philos_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Philosophy
mean(as.numeric(Philos_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r Sociology}
### Sociology ###
Soc_subset_Low <- TSR_data[TSR_data$Sociologyemployability < 3 & TSR_data$Sociologyemployability != 0, ]

Soc_subset_High <- TSR_data[TSR_data$Sociologyemployability > 3, ]

## Theology employability
#Low employability in Sociology
mean(as.numeric(Soc_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Sociology
mean(as.numeric(Soc_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Sociology
mean(as.numeric(Soc_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Sociology
mean(as.numeric(Soc_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r Psychology}
### Psychology ###
Psych_subset_Low <- TSR_data[TSR_data$PsychologyEmployability < 3 & TSR_data$PsychologyEmployability != 0, ]

Psych_subset_High <- TSR_data[TSR_data$PsychologyEmployability > 3, ]

## Theology employability
#Low employability in Psychology
mean(as.numeric(Psych_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Psychology
mean(as.numeric(Psych_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Psychology
mean(as.numeric(Psych_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Psychology
mean(as.numeric(Psych_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r History}
### History ###
Hist_subset_Low <- TSR_data[TSR_data$Historyemployability < 3 & TSR_data$Historyemployability != 0, ]

Hist_subset_High <- TSR_data[TSR_data$Historyemployability > 3, ]

## Theology employability
#Low employability in History
mean(as.numeric(Hist_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in History
mean(as.numeric(Hist_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in History
mean(as.numeric(Hist_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in History
mean(as.numeric(Hist_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r Ethics}
### Ethics ###
Ethics_subset_Low <- TSR_data[TSR_data$Ethicsemployability < 3 & TSR_data$Ethicsemployability != 0, ]

Ethics_subset_High <- TSR_data[TSR_data$Ethicsemployability > 3, ]

## Theology employability
#Low employability in Ethics
mean(as.numeric(Ethics_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Ethics
mean(as.numeric(Ethics_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Ethics
mean(as.numeric(Ethics_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Ethics
mean(as.numeric(Ethics_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r Politics}
### Politics ###
Polit_subset_Low <- TSR_data[TSR_data$Politicsemployability < 3 & TSR_data$Politicsemployability != 0, ]

Polit_subset_High <- TSR_data[TSR_data$Politicsemployability > 3, ]

## Theology employability
#Low employability in Politics
mean(as.numeric(Polit_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Politics
mean(as.numeric(Polit_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Politics
mean(as.numeric(Polit_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Politics
mean(as.numeric(Polit_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r English}
### English ###
Eng_subset_Low <- TSR_data[TSR_data$Englishemployability < 3 & TSR_data$Englishemployability != 0, ]

Eng_subset_High <- TSR_data[TSR_data$Englishemployability > 3, ]

## Theology employability
#Low employability in English
mean(as.numeric(Eng_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in English
mean(as.numeric(Eng_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in English
mean(as.numeric(Eng_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in English
mean(as.numeric(Eng_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r Math}
### Math ###
Math_subset_Low <- TSR_data[TSR_data$Mathemployability < 3 & TSR_data$Mathemployability != 0, ]

Math_subset_High <- TSR_data[TSR_data$Mathemployability > 3, ]

## Theology employability
#Low employability in Math
mean(as.numeric(Math_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Math
mean(as.numeric(Math_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Math
mean(as.numeric(Math_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Math
mean(as.numeric(Math_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r Computer Science}
### Computer Science ###
CompSci_subset_Low <- TSR_data[TSR_data$ComputerScienceemployability < 3 & TSR_data$ComputerScienceemployability != 0, ]

CompSci_subset_High <- TSR_data[TSR_data$ComputerScienceemployability > 3, ]

## Theology employability
#Low employability in Computer Science
mean(as.numeric(CompSci_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Computer Science
mean(as.numeric(CompSci_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Computer Science
mean(as.numeric(CompSci_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Computer Science
mean(as.numeric(CompSci_subset_High$ReligiousStudiesemployability), na.rm = TRUE)
```

```{r Business}
### Business ###
Busi_subset_Low <- TSR_data[TSR_data$Businessemployability < 3 & TSR_data$Businessemployability != 0, ]

Busi_subset_High <- TSR_data[TSR_data$Businessemployability > 3, ]

## Theology employability
#Low employability in Business
mean(as.numeric(Busi_subset_Low$Theologyemployability), na.rm = TRUE)
#High employability in Business
mean(as.numeric(Busi_subset_Low$Theologyemployability), na.rm = TRUE)

## Religious Studies employability
#Low employability in Business
mean(as.numeric(Busi_subset_Low$ReligiousStudiesemployability), na.rm = TRUE)
#High employability in Business
mean(as.numeric(Busi_subset_High$ReligiousStudiesemployability), na.rm = TRUE)

```
